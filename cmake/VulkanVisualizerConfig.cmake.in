# VulkanVisualizerConfig.cmake
# =============================================================================
# This file allows other projects to use VulkanVisualizer via find_package()
# =============================================================================

@PACKAGE_INIT@

include(CMakeFindDependencyMacro)
find_dependency(Vulkan REQUIRED)

include(${CMAKE_CURRENT_LIST_DIR}/VulkanVisualizerTargets.cmake)

set(VulkanVisualizer_VERSION @PROJECT_VERSION@)
set(VulkanVisualizer_FOUND TRUE)

# Set variables for third-party dependencies
set(VulkanVisualizer_DLL_DIR "${PACKAGE_PREFIX_DIR}/@CMAKE_INSTALL_BINDIR@")
set(VulkanVisualizer_LIB_DIR "${PACKAGE_PREFIX_DIR}/@CMAKE_INSTALL_LIBDIR@")
set(VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR "${PACKAGE_PREFIX_DIR}/@CMAKE_INSTALL_INCLUDEDIR@/vulkan_visualizer/third_party")

# Add third-party include directories to the imported target
# This allows consumers to #include <imgui.h>, <SDL3/SDL.h>, etc.
set_target_properties(VulkanVisualizer::vulkan_visualizer PROPERTIES
    INTERFACE_INCLUDE_DIRECTORIES "$<BUILD_INTERFACE:${PACKAGE_PREFIX_DIR}/@CMAKE_INSTALL_INCLUDEDIR@>;$<BUILD_INTERFACE:${VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR}>;$<BUILD_INTERFACE:${VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR}/imgui>;$<BUILD_INTERFACE:${VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR}/imgui/backends>;$<INSTALL_INTERFACE:@CMAKE_INSTALL_INCLUDEDIR@>;$<INSTALL_INTERFACE:@CMAKE_INSTALL_INCLUDEDIR@/vulkan_visualizer/third_party>;$<INSTALL_INTERFACE:@CMAKE_INSTALL_INCLUDEDIR@/vulkan_visualizer/third_party/imgui>;$<INSTALL_INTERFACE:@CMAKE_INSTALL_INCLUDEDIR@/vulkan_visualizer/third_party/imgui/backends>"
)

# On Windows, link SDL3 import library
if(WIN32)
    if(EXISTS "${VulkanVisualizer_LIB_DIR}/SDL3.lib")
        # Create imported target for SDL3
        if(NOT TARGET SDL3::SDL3-shared)
            add_library(SDL3::SDL3-shared SHARED IMPORTED)
            set_target_properties(SDL3::SDL3-shared PROPERTIES
                IMPORTED_LOCATION "${VulkanVisualizer_DLL_DIR}/SDL3.dll"
                IMPORTED_IMPLIB "${VulkanVisualizer_LIB_DIR}/SDL3.lib"
                INTERFACE_INCLUDE_DIRECTORIES "${VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR}/SDL3"
            )
        endif()

        # Link SDL3 to VulkanVisualizer target
        set_property(TARGET VulkanVisualizer::vulkan_visualizer APPEND PROPERTY
            INTERFACE_LINK_LIBRARIES SDL3::SDL3-shared
        )
    endif()
endif()

if(NOT VulkanVisualizer_FIND_QUIETLY)
    message(STATUS "Found VulkanVisualizer ${VulkanVisualizer_VERSION}")
    message(STATUS "  Third-party headers: ${VulkanVisualizer_THIRD_PARTY_INCLUDE_DIR}")
    if(WIN32 AND EXISTS "${VulkanVisualizer_LIB_DIR}/SDL3.lib")
        message(STATUS "  SDL3 library: ${VulkanVisualizer_LIB_DIR}/SDL3.lib")
    endif()
endif()
